@using CarsBg_System.Models.Api.Price
@model CarDetailViewModel

@{
    byte isActive = 0;
    int count = @Model.ImagesId.Count();
}

<!DOCTYPE html>
<html lang="en">
<head>
    <title>Car Details</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="~/css/site.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

    <style>

        .carousel-inner img {
            width: 45%;
            margin: auto;
            min-height: 200px;
        }

        .carousel-caption {
            display: none;
        }

        }
    </style>
</head>
<body>



    <div id="myCarousel" class="carousel slide" data-ride="carousel">

        <ol class="carousel-indicators">
            <li data-target="#myCarousel" data-slide-to="0" class="active"></li>

            @for (int i = 1; i < @count; i++)
            {
                <li data-target="#myCarousel" data-slide-to="@i"></li>
            }>
        </ol>

        <!-- Wrapper for slides -->
        <div class="carousel-inner" role="listbox">

            @foreach (var carImage in @Model.ImagesId)
            {
                @if (isActive == 0)
                {
                    isActive++;

                    <div class="item active">
                        <a href="/Car/OriginalImages/@carImage">
                            <img src="/Car/CourseImages/@carImage" />
                        </a>
                    </div>
                }
                else
                {
                    <div class="item">
                        <a href="/Car/OriginalImages/@carImage">
                            <img src="/Car/CourseImages/@carImage" />
                        </a>
                    </div>
                }
            }
        </div>

        <!-- Left and right controls -->
        <a class="left carousel-control" href="#myCarousel" role="button" data-slide="prev">
            <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
        </a>
        <a class="right carousel-control" href="#myCarousel" role="button" data-slide="next">
            <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
        </a>
    </div>

    <div class="container text-center">
        <h3>@Model.Name</h3><br>
        <div class="row">
            <div class="col-sm-4">
                <div class="well">
                    <p>Some text..</p>
                    <p>Some text..</p>
                    <p>Some text..</p>
                    <p>Some text..</p>
                    <p>Some text..</p>
                    <p>Some text..</p>
                    <p>Some text..</p>
                </div>
            </div>
            <div class="col-sm-4">
                <div class="well">
                    <p>Some text..</p>
                    <p>Some text..</p>
                    <p>Some text..</p>
                    <p>Some text..</p>
                    <p>Some text..</p>
                    <p>Some text..</p>
                    <p>Some text..</p>
                </div>
            </div>
            <div class="col-sm-4">
                <div class="well">
                    <p>Some text..</p>
                    <p>Some text..</p>
                    <p>Some text..</p>
                    <p>Some text..</p>
                    <p>Some text..</p>
                    <p>Some text..</p>
                    <p>Some text..</p>
                </div>
            </div>
            <div class="col-sm-4">
                <div class="panel panel-default text-left">
                    <div class="panel-body">
                        <p id="prices-p">Click here to show price change</p>

                        <div class="d-none" id="prices">

                            <p id="date"></p>
                            <p id="price"></p>

                        </div>

                        <button type="button" class="btn btn-primary" id="prices-button">
                            Check
                        </button>
                    </div>
                </div>
            </div>
            <div class="col-sm-8">
                <div class="well">
                    <h1 style="background-color:powderblue;">Description</h1>
                    <p>@Model.Description</p>

                </div>
            </div>
        </div>
    </div>
    <br>

    @section Scripts {
    <script>
        $('#prices-button').on('click', () => {
            $.get('/api/prices/@Model.Id', (data) => {

                if (data && data.prices && data.prices.length > 0) {
                    $('#prices-p').addClass('d-none');
                    $('#prices-button').addClass('d-none');


                    $('#prices').empty();


                    data.prices.forEach((price) => {
                        $('#prices').append(`<p>Date: ${price.date}</p><p>Price: ${price.price}</p>`);
                    });

                    $('#prices').removeClass('d-none');
                    $('#prices-button').hide();
                } else {

                    console.log('No data found');
                }
            });
        });
    </script>
    }

</body>
</html>











